<template>
  <div style="overflow-x: auto; overflow-y: auto">
    <table
      aria-multiselectable="true"
      class="slds-table slds-no-cell-focus slds-table_bordered slds-table_edit"
      role="grid"
    >
      <thead>
        <tr>
          <th
            aria-label="Name"
            aria-sort="none"
            class="slds-is-resizable slds-is-sortable"
            scope="col"
          >
            <a
              class="slds-th__action slds-text-link_reset"
              href="#"
              role="button"
              tabindex="-1"
            >
              <span class="slds-assistive-text">Sort by: </span>
              <div
                class="slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate"
              >
                <span class="slds-truncate" title="First Name">First Name</span>
                <span class="slds-icon_container slds-icon-utility-arrowdown">
                  <lightning-icon
                    icon-name="utility:arrowdown"
                    aleternative-test="arrowdown"
                    title="arrowdown"
                    size="xx-small"
                    class="slds-var-m-left_small color-blue"
                  ></lightning-icon>
                </span>
              </div>
            </a>
            <div class="slds-resizable">
              <input
                type="range"
                aria-label="Name column width"
                class="slds-resizable__input slds-assistive-text"
                id="cell-resize-handle-533"
                max="1000"
                min="20"
                tabindex="-1"
              />
              <span class="slds-resizable__handle">
                <span class="slds-resizable__divider"></span>
              </span>
            </div>
          </th>
          <th
            aria-label="Last Name"
            aria-sort="none"
            class="slds-is-resizable slds-is-sortable"
            scope="col"
          >
            <a
              class="slds-th__action slds-text-link_reset"
              href="#"
              role="button"
              tabindex="-1"
            >
              <span class="slds-assistive-text">Sort by: </span>
              <div
                class="slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate"
              >
                <span class="slds-truncate" title="Last Name">Last Name</span>
                <span class="slds-icon_container slds-icon-utility-arrowdown">
                  <lightning-icon
                    icon-name="utility:arrowdown"
                    aleternative-test="arrowdown"
                    title="arrowdown"
                    size="xx-small"
                    class="slds-var-m-left_small color-blue"
                  ></lightning-icon>
                </span>
              </div>
            </a>
            <div class="slds-resizable">
              <input
                type="range"
                aria-label="Last Name column width"
                class="slds-resizable__input slds-assistive-text"
                id="cell-resize-handle-534"
                max="1000"
                min="20"
                tabindex="-1"
              />
              <span class="slds-resizable__handle">
                <span class="slds-resizable__divider"></span>
              </span>
            </div>
          </th>
          <th
            aria-label="Birth Date"
            aria-sort="none"
            class="slds-is-resizable slds-is-sortable"
            scope="col"
          >
            <a
              class="slds-th__action slds-text-link_reset"
              href="#"
              role="button"
              tabindex="-1"
            >
              <span class="slds-assistive-text">Sort by: </span>
              <div
                class="slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate"
              >
                <span class="slds-truncate" title="Birth Date">Birth Date</span>
                <span class="slds-icon_container slds-icon-utility-arrowdown">
                  <lightning-icon
                    icon-name="utility:arrowdown"
                    aleternative-test="arrowdown"
                    title="arrowdown"
                    size="xx-small"
                    class="slds-var-m-left_small color-blue"
                  ></lightning-icon>
                </span>
              </div>
            </a>
            <div class="slds-resizable">
              <input
                type="range"
                aria-label="Birth Date column width"
                class="slds-resizable__input slds-assistive-text"
                id="cell-resize-handle-535"
                max="1000"
                min="20"
                tabindex="-1"
              />
              <span class="slds-resizable__handle">
                <span class="slds-resizable__divider"></span>
              </span>
            </div>
          </th>
          <th
            aria-label="Stage"
            aria-sort="none"
            class="slds-is-resizable slds-is-sortable"
            scope="col"
          >
            <a
              class="slds-th__action slds-text-link_reset"
              href="#"
              role="button"
              tabindex="-1"
            >
              <span class="slds-assistive-text">Sort by: </span>
              <div
                class="slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate"
              >
                <span class="slds-truncate" title="Lead Source"
                  >Lead Source</span
                >
                <span class="slds-icon_container slds-icon-utility-arrowdown">
                  <lightning-icon
                    icon-name="utility:arrowdown"
                    aleternative-test="arrowdown"
                    title="arrowdown"
                    size="xx-small"
                    class="slds-var-m-left_small color-blue"
                  ></lightning-icon>
                </span>
              </div>
            </a>
            <div class="slds-resizable">
              <input
                type="range"
                aria-label="Lead Source column width"
                class="slds-resizable__input slds-assistive-text"
                id="cell-resize-handle-536"
                max="1000"
                min="20"
                tabindex="-1"
              />
              <span class="slds-resizable__handle">
                <span class="slds-resizable__divider"></span>
              </span>
            </div>
          </th>
          <th
            aria-label="Email"
            aria-sort="none"
            class="slds-is-resizable slds-is-sortable"
            scope="col"
          >
            <a
              class="slds-th__action slds-text-link_reset"
              href="#"
              role="button"
              tabindex="-1"
            >
              <span class="slds-assistive-text">Sort by: </span>
              <div
                class="slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate"
              >
                <span class="slds-truncate" title="Email">Email</span>
                <span class="slds-icon_container slds-icon-utility-arrowdown">
                  <lightning-icon
                    icon-name="utility:arrowdown"
                    aleternative-test="arrowdown"
                    title="arrowdown"
                    size="xx-small"
                    class="slds-var-m-left_small color-blue"
                  ></lightning-icon>
                </span>
              </div>
            </a>
            <div class="slds-resizable">
              <input
                type="range"
                aria-label="Email column width"
                class="slds-resizable__input slds-assistive-text"
                id="cell-resize-handle-537"
                max="1000"
                min="20"
                tabindex="-1"
              />
              <span class="slds-resizable__handle">
                <span class="slds-resizable__divider"></span>
              </span>
            </div>
          </th>
        </tr>
      </thead>
      <tbody>
        <template for:each={contactsObj} for:item="contact">
          <tr aria-selected="false" class="slds-hint-parent" key={contact.Id}>
            <td
              class="slds-cell-edit td-edit"
              scope="row"
              tabindex="0"
              data-inlineid={contact.inlinefnameId}
            >
              <span class="slds-grid slds-grid_align-spread">
                <span
                  class="slds-truncate"
                  onclick={handleNavigation}
                  id={contact.Id}
                  tabindex="-1"
                  title={contact.FirstName}
                  data-spanid={contact.Id}
                  >{contact.FirstName}
                </span>
                <button
                  class="slds-button slds-button_icon slds-cell-edit__button slds-var-m-left_x-small td-edit-button td-edit-button"
                  tabindex="-1"
                  title="Edit First Name"
                  onclick={handleInlineEdit}
                  data-id={contact.Id}
                  data-fieldname="FirstName"
                  data-value={contact.FirstName}
                >
                  <lightning-icon
                    title="Edit"
                    icon-name="utility:edit"
                    alternative-text="Edit"
                    size="xx-small"
                  ></lightning-icon>
                  <span class="slds-assistive-text">Edit First Name</span>
                </button>
              </span>

              <!-- inline edit -->
              <lightning-input
                label=""
                onblur={handleInlineOffFocus}
                variant="label-hidden"
                data-inlinesectionid={contact.inlinefnameId}
                type="text"
                class="slds-popover slds-popover slds-popover_edit slds-var-p-around_xx-small slds-input"
                placeholder="Enter First Name"
                value={inlineEditChangedValue}
                onchange={handleInlineEditOnChange}
                style="
                  position: absolute;
                  top: 0;
                  left: 0.0625rem;
                  display: none;
                "
              ></lightning-input>
            </td>
            <td
              class="slds-cell-edit td-edit"
              role="gridcell"
              data-inlineid={contact.inlinelnameId}
            >
              <span class="slds-grid slds-grid_align-spread">
                <span class="slds-truncate" title={contact.LastName}
                  >{contact.LastName}</span
                >
                <button
                  class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small td-edit-button"
                  tabindex="-1"
                  title="Edit Last Name"
                  onclick={handleInlineEdit}
                  data-id={contact.Id}
                  data-fieldname="LastName"
                  data-value={contact.LastName}
                >
                  <lightning-icon
                    title="Edit"
                    icon-name="utility:edit"
                    alternative-text="Edit"
                    size="xx-small"
                    aria-hidden="true"
                  ></lightning-icon>
                  <span class="slds-assistive-text">Edit Last Name</span>
                </button>
              </span>

              <lightning-input
                label=""
                onblur={handleInlineOffFocus}
                variant="label-hidden"
                data-inlinesectionid={contact.inlinelnameId}
                type="text"
                class="slds-popover slds-popover slds-popover_edit slds-var-p-around_xx-small slds-input"
                placeholder="Enter Last Name"
                value={inlineEditChangedValue}
                onchange={handleInlineEditOnChange}
                style="
                  position: absolute;
                  top: 0;
                  left: 0.0625rem;
                  display: none;
                "
              ></lightning-input>
            </td>
            <td
              class="slds-cell-edit td-edit"
              role="gridcell"
              data-inlineid={contact.inlinebirthdateId}
            >
              <span class="slds-grid slds-grid_align-spread">
                <span class="slds-truncate" title={contact.Birthdate}
                  >{contact.Birthdate}</span
                >
                <button
                  class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small td-edit-button"
                  tabindex="-1"
                  title="Edit Birth Date"
                  onclick={handleInlineEdit}
                  data-id={contact.Id}
                  data-fieldname="Birthdate"
                  data-value={contact.Birthdate}
                >
                  <lightning-icon
                    title="Edit"
                    icon-name="utility:edit"
                    alternative-text="Edit"
                    size="xx-small"
                  ></lightning-icon>
                  <span class="slds-assistive-text">Edit birth Date</span>
                </button>
              </span>

              <lightning-input
                label=""
                onblur={handleInlineOffFocus}
                data-inlinesectionid={contact.inlinebirthdateId}
                type="date"
                section
                class="slds-popover slds-popover slds-popover_edit slds-var-p-around_xx-small slds-input"
                placeholder="Enter Birthdate"
                value={inlineEditChangedValue}
                onchange={handleInlineEditOnChange}
                style="
                  position: absolute;
                  top: 0;
                  left: 0.0625rem;
                  display: none;
                "
                variant="label-hidden"
              ></lightning-input>
            </td>
            <td
              class="slds-cell-edit td-edit"
              role="gridcell"
              data-inlineid={contact.inlineleadsourceId}
            >
              <span class="slds-grid slds-grid_align-spread">
                <span class="slds-truncate" title={contact.LeadSource}
                  >{contact.LeadSource}</span
                >
                <button
                  class="slds-button slds-button_icon slds-cell-edit__button slds-var-m-left_x-small td-edit-button"
                  tabindex="-1"
                  title="Edit lead source"
                  onclick={handleInlineEdit}
                  data-id={contact.Id}
                  data-fieldname="LeadSource"
                  data-value={contact.LeadSource}
                >
                  <lightning-icon
                    title="Edit"
                    icon-name="utility:edit"
                    alternative-text="Edit"
                    size="xx-small"
                  ></lightning-icon>
                  <span class="slds-assistive-text">Edit lead source</span>
                </button>
              </span>

              <lightning-combobox
                data-inlinesectionid={contact.inlineleadsourceId}
                onblur={handleInlineOffFocus}
                class="slds-popover slds-popover_edit"
                variant="label-hidden"
                style="
                  position: absolute;
                  top: 0;
                  left: 0.0625rem;
                  display: none;
                "
                placeholder="Enter Lead Source"
                value={inlineEditChangedValue}
                onchange={handleInlineEditOnChange}
                name="Lead Source"
                options={leadSourceOptions}
              ></lightning-combobox>
            </td>
            <td
              class="slds-cell-edit td-edit"
              role="gridcell"
              data-inlineid={contact.inlineemailId}
            >
              <span class="slds-grid slds-grid_align-spread">
                <span class="slds-truncate" title={contact.Email}
                  >{contact.Email}</span
                >
                <button
                  class="slds-button slds-button_icon slds-cell-edit__button slds-var-m-left_x-small td-edit-button"
                  tabindex="-1"
                  title="Edit Email"
                  onclick={handleInlineEdit}
                  data-id={contact.Id}
                  data-fieldname="Email"
                  data-value={contact.Email}
                >
                  <lightning-icon
                    title="Edit"
                    icon-name="utility:edit"
                    alternative-text="Edit"
                    size="xx-small"
                  ></lightning-icon>
                  <span class="slds-assistive-text">Edit email</span>
                </button>
              </span>

              <lightning-input
                label=""
                onblur={handleInlineOffFocus}
                data-inlinesectionid={contact.inlineemailId}
                type="emailsection"
                class="slds-popover slds-popover slds-popover_edit slds-var-p-around_xx-small slds-input"
                placeholder="Enter Email"
                value={inlineEditChangedValue}
                onchange={handleInlineEditOnChange}
                style="
                  position: absolute;
                  top: 0;
                  left: 0.0625rem;
                  display: none;
                "
                variant="label-hidden"
              ></lightning-input>
            </td>
          </tr>
        </template>
      </tbody>
      <template if:true={isEditing}>
        <tfoot>
          <tr class="slds-clearfix" style="width: 100%">
            <td colspan="5" class="slds-float_right">
              <lightning-button
                label="Cancel"
                onclick={handleInlineCancel}
                class="slds-var-m-horizontal_xx-small"
              ></lightning-button>
              <lightning-button
                variant="brand"
                label="Save"
                onclick={handleInlineSave}
              ></lightning-button>
            </td>
          </tr>
        </tfoot>
      </template>
    </table>
  </div>
</template>